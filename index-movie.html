<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

        <!--Import Google Icon Font-->
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
        <!-- Compiled and minified CSS -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    
        <!--Import materialize.css-->
        <!-- <link type="text/css" rel="stylesheet" href="css/materialize.min.css"  media="screen,projection"/> -->
    
        <!--Let browser know website is optimized for mobile-->
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/> 
        
        <!-- FontAwesome -->
        <script src="https://kit.fontawesome.com/043a87e592.js" crossorigin="anonymous"></script>
        
    <title>Junkie Awesome</title>

    <style>
    body {
        /* padding:10px; */
    }
    .food-btn{
        width: 90px;
        height: 45px;
        background-color: rgb(41, 160, 144);
        color: white;
        font-size: 22px;
        /* font-weight: bold; */
        margin: 10px 10px 10px 10px;
    }
    #header{
        margin: 10px;
        padding:0px;
    }
    /* .slider {
        height: 200px;
    } */

    #buttonList, #beerOutput, #movies-view {
        padding :20px;
    }
    </style>
</head>

<body>
    <!-- Nav bar -->  
    <div class="navbar-fixed">
        <nav class="teal">
            <div class= "container">
                <div class="nav-wrapper"> 
                    <a href="#!" class="brand-logo center col s12" ><h4 id="header">Junkie Awesome</h4></a>
                </div>
            </div>
        </nav>
    </div>

    <!-- Carousel -->  
    <div class="slider">
            <ul class="slides">
              <li>
                <img src="imgShine/20191031_121029.png"> <!-- random image -->
                <div class="caption center-align">
                  <h3>Start with your food!</h3>
                  <h5 class="light grey-text text-lighten-3 hide-on-small-only">Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book.</h5>
                </div>
              </li>
              <li>
                <img src="imgShine/20191031_121209.png"> <!-- random image -->
                <div class="caption left-align">
                  <h3>Beer along with your food!</h3>
                  <h5 class="light grey-text text-lighten-3 hide-on-small-only">Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book.</h5>
                </div>
              </li>
              <li>
                <img src="imgShine/20191031_121630.png"> <!-- random image -->
                <div class="caption right-align">
                  <h3>Time to dive in your movie!!</h3>
                  <h5 class="light grey-text text-lighten-3 hide-on-small-only">Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book.</h5>
                </div>
              </li>              
            </ul>
          </div>

    <!-- Section: search -->             
    <section id="search" class="section section-search teal darken-1 white-text center scrollspy">
        <div class="container">
            <div class="row">
                <div class="col s12">
                    <h4>Search Foods</h4>
                    <!-- <form id="food-form"> -->
                            <!-- <label for="food-input">What food would you like to search?</label> -->
                            <input type="text" id="food-input" class="white grey-text autocomplete" placeholder="cheese, steak, apple, etc...">
                                              
                            <!-- Buttontriggers new movie to be added -->
                            <!-- <input id="search" type="submit" value="Search">  -->
                    <!-- </form> -->
                </div>
            </div>
        </div>
    </section>       

    <!-- Button list -->   
    <div id="buttonView"></div>

    <div class="beerInformation">
        <h4 class="header">Beer with the Food!</h4>
        <div class= "beerUl">
            <ul id="beerView">
                <li class= "beerLi"></li>
            </ul>
        </div>
    </div> 

<!--     <div class="col s12 m7" id="beerCard">
        <h3 class="header">Beer with the food!</h3>
        <div class="card horizontal">
          <div class="card-image" id="beerImag">
            <!-- <img src="https://lorempixel.com/100/190/nature/6"> -->
         <!--  </div>
          <div class="card-stacked">
            <div class="card-content" id="description">
              <!-- <p>I am a very simple card. I am good at containing small bits of information.</p> -->
            <!-- </div>
            <div class="card-action">
              <a href="#">This is a link</a>
            </div>
          </div>
        </div>
      </div>   --> 
    
    <div id="moviesInformation">
        <h4 class="header">Movie with the Beer!</h4>
        <div class= "movieUl">
            <ul id="moviesView">
                <li class= "movieLi"></li>
            </ul>
        </div>
    </div> 
</body>

<!-- Compiled and minified JavaScript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script> -->
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>     -->
    
  <script text="text/javascript">

    //slider
    const slider = document.querySelector('.slider');
    M.Slider.init(slider, {
        indicators: false,
        height: 500,
        transition: 500,
        interval:4000
    })

    $(document).ready(function() { 

        var foodButton= [];
    //1 -----------------------------------------------------
        function arrayButtons() {
            console.log(1);

            $("#buttonsView").empty();

            for (var i= 0; i < foodButton.length; i++) {

                var button = $("<button>");

                button.addClass("food-btn");
                button.attr("data-name", foodButton[i]);
                button.text(foodButton[i]);

                $("#buttonView").prepend(button);
            }
        } 
    //2 -----------------------------------------------------
        // $("#search").on("click", function(event) { 

        $("#food-input").keyup(function(event){  
            event.preventDefault();
            console.log(2);

            if(event.keyCode === 13){
                var newFood = $("#food-input").val().trim();
                    if(newFood) {
                        // addFood(newFood);
                        foodButton.push(newFood);
                    }
                newFood.val = "";
            }

            arrayButtons();
            // newFood 를 블러야 실행이 되는 것인데 실행시키지 않았었던 것
            // newFood 버튼을 설정하고, 부르고, api 기능으로 실행시키는 것
            getFoodData(newFood);            
        });
    //3 ------------------------------------------------------ 
        $(document).on("click", ".food-btn", getFoodData);
        //$(".food-btn").on("click", getFoodData);
            console.log(3);

    //4  ======================================================
        function getFoodData(newFood) {
            
            // var APIKey = "472257543d9345308ea5ac03e502def3";  
            var userInput = newFood;
            var queryURL = "https://api.punkapi.com/v2/beers/?food=" + userInput;
            
            $.ajax({
                url: queryURL,
                method: "GET"         
            }).then(function(response) {
                console.log("4");
                console.log(response);

                var year = response[0].first_brewed.slice(3);
                console.log(response[0].first_brewed.slice(3));

                showFoodData(response);
                getMovieData(year);
                //  $("#beerOutput").text(JSON.stringify(response));                
            });
        }        
    //5 ------------------------------------------------------ 
        function showFoodData(response) {
            console.log("5");

            // $("#beerCard").empty();

            var foodDiv = $("<div class= 'foodData'>");

            var name = response[0].name;            
            var firstBrewed = response[0].first_brewed.slice(3);            
            var description = response[0].description;
            var foodPairing = response[0].food_pairing;
            
            var pOne = $("<h5>").html("BeerName :  " + name);
            var pTwo = $("<h6>").html("FirstBrewed :  " + firstBrewed);           
            var pThree = $("<h6>").html("Description : " +  '<br>' + description);
            var pFour = $("<h6>").html("Food_paring : " +  '<br>' + foodPairing);

            foodDiv.append(pOne);
            foodDiv.append(pTwo);               
            foodDiv.append(pThree);
            foodDiv.append(pFour);

            $("#beerView").append(foodDiv);
            //-------------------------------------------
            // var beerDiv = $("<div class= 'beerData>");

            var imageURL = response[0].image_url;
            var img = $("<img>").attr("src", imageURL);
            foodDiv.append(img);

            // $("#beerView").prepend(beerDiv);
        }        
    //5-1 ------------------------------------------------------
        var listFoodData = [];
        var id = 0;

        function listFoodData(response) {

            var foodData = $("<li>");
            var button = $("<button>").text(cityList[i]); 
            button.addClass("cityButton");             

            listFoodData.append(foodData);

            $("#beerView").append(foodList);

        }
    //6  =============================================================

        function getMovieData(year) {            
            
            // var movie = $(this).attr("data-name");
            // var year = firstBrewed;
            var queryURL = "http://www.omdbapi.com/?apikey=3f779744&t=beer&y=" + year;
                  
            $.ajax({
              url: queryURL,
              method: "GET"
            }).then(function(response) {             
                console.log("6");
                console.log(response);

                // showFoodData(response);
                showMovieData(response);
            });
        }

     //7 ------------------------------------------------------
        function showMovieData(response) {
            console.log("7");

            var movieDiv = $("<div class='movie'>");          
            
            var title = response.Title;
            var plot = response.Plot;
            var director = response.Director;
            var actors = response.Actors;           
            var country = response.Country;

            var pOne = $("<p>").text("Title: " + title);
            var pTwo = $("<p>").text("Plot: " + plot);
            var pThree = $("<p>").text("Director: " + director);
            var pFour = $("<p>").text("Actors: " + actors);            
            var pFive = $("<p>").text("Country: " + country);          
            
            movieDiv.append(pOne);
            movieDiv.append(pTwo);
            movieDiv.append(pThree);
            movieDiv.append(pFour);
            movieDiv.append(pFive);

            var imgURL = response.Poster;
            var image = $("<img>").attr("src", imgURL);           
            movieDiv.append(image);

            $("#moviesView").append(movieDiv);
        }      

    arrayButtons();
        
    });
  </script> 

</body>
</html> 